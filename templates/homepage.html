<html>
    <head>
        <title>SnD</title>
    </head>
    <body>
        <label>Interface</label>
        <input type="text" value="{{ config.0 }}" disabled><br>
        <label>Current IP</label>
        <input type="text" value="{{ config.1 }}" disabled><br>
        <label>Current MAC</label>
        <input type="text" value="{{ config.2 }}" disabled><br>
        <br>
        <label>TCP SYN Flood</label>
        <input type="text" value="{{ flags['TCP-SYN']['flag'] }}" id="TCP-SYN" disabled><br>
        <label>TCP SYN-ACK Flood</label>
        <input type="text" value="{{ flags['TCP-SYNACK']['flag'] }}" id="TCP-SYNACK" disabled><br>
        <label>Ping of Death</label>
        <input type="text" value="{{ flags['ICMP-POD']['flag'] }}" id="ICMP-POD" disabled><br>
        <label>ICMP Smurf Attack</label>
        <input type="text" value="{{ flags['ICMP-SMURF']['flag'] }}" id="ICMP-SMURF" disabled><br>
        <br>
        <textarea id="activities" style="width: 100%; height: 40vh;"></textarea>
        <textarea id="logs" style="width: 100%; height: 20vh;"></textarea>
        <br><br>
        <button type="button" id="start-sniffer">START</button>
        <button type="button" id="stop-sniffer">STOP</button>
        <script type="text/javascript">
        var ws = new WebSocket('ws://' + document.domain + ':' + location.port + '/ws');
        var _element = document.getElementById('activities');
        var _element2 = document.getElementById('logs');
        var _startButton = document.getElementById('start-sniffer');
        var _stopButton = document.getElementById('stop-sniffer');
        ws.onmessage = function (event) {
            switch (String(event.data).slice(0,5)) {
                case 'LOG::':
                    _element2.innerHTML += event.data + "\n";
                    break;
                case 'PKT::':
                    _element.innerHTML = String(event.data).slice(5);
                    break;
                case 'FLAG:':
                    var data = String(event.data).slice(5).split(',');
                    var _temp = document.getElementById('TCP-SYN');
                    _temp.value = data[0];
                    _temp = document.getElementById('TCP-SYNACK');
                    _temp.value = data[1];
                    _temp = document.getElementById('ICMP-POD');
                    _temp.value = data[2];
                    _temp = document.getElementById('ICMP-SMURF');
                    _temp.value = data[3];
                    break;
                default:
                    console.log(event.data);
            }
        };
        ws.onerror = function (event) {
            _startButton.setAttribute('disabled', 'disabled');
            _stopButton.setAttribute('disabled', 'disabled');
            alert('WebSocket Connection Failed');
        };
        ws.onopen = function () {
            _startButton.onclick = function () {
                ws.send('CMD::START');
            };
            _stopButton.onclick = function () {
                ws.send('CMD::STOP');
            };
        };
        </script>
    </body>
</html>